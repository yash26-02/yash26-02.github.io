<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YGWIN | ADMIN PANEL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { background: #010409; color: #e6edf3; font-family: 'Inter', sans-serif; padding-bottom: 50px; }
        .orbitron { font-family: 'Orbitron', sans-serif; }
        .admin-card { background: #0d1117; border: 1px solid #30363d; border-radius: 12px; padding: 15px; margin-bottom: 15px; }
        .hidden { display: none !important; }
        input { background: #010409 !important; border: 1px solid #30363d !important; color: white !important; }
        .btn-action { font-size: 9px; padding: 4px 8px; border-radius: 4px; font-weight: bold; }
    </style>
</head>
<body class="p-3">

    <div id="admin-login" class="max-w-md mx-auto mt-20 p-6 admin-card text-center">
        <h1 class="text-2xl font-black text-yellow-500 orbitron mb-6">ADMIN LOGIN</h1>
        <input type="number" id="adm-id" placeholder="Admin ID" class="w-full p-3 rounded-lg mb-3 outline-none">
        <input type="password" id="adm-pass" placeholder="Password" class="w-full p-3 rounded-lg mb-6 outline-none">
        <button onclick="checkAdmin()" class="w-full bg-yellow-500 text-black font-black py-3 rounded-lg">ENTER TERMINAL</button>
    </div>

    <div id="admin-panel" class="hidden max-w-2xl mx-auto">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-xl font-black text-yellow-500 orbitron italic">YGWIN CONTROL</h1>
            <button onclick="location.reload()" class="bg-red-500/10 text-red-500 text-[10px] px-3 py-1 rounded border border-red-500/20 font-bold">LOGOUT</button>
        </div>

        <div class="admin-card border-l-4 border-yellow-500">
            <h2 class="text-[10px] font-bold text-gray-500 uppercase mb-3">Live Bet Monitoring</h2>
            <div class="grid grid-cols-2 gap-3 text-center">
                <div class="bg-orange-600/10 p-3 rounded-lg border border-orange-600/20"><p class="text-[10px] font-bold text-orange-500">BIG TOTAL</p><p id="big-total" class="text-xl font-black orbitron text-white">₹0</p></div>
                <div class="bg-indigo-600/10 p-3 rounded-lg border border-indigo-600/20"><p class="text-[10px] font-bold text-indigo-500">SMALL TOTAL</p><p id="small-total" class="text-xl font-black orbitron text-white">₹0</p></div>
            </div>
        </div>

        <div class="admin-card">
            <h2 class="text-[10px] font-bold text-gray-400 mb-3 uppercase tracking-widest">Manual Result Force</h2>
            <div class="flex gap-2">
                <button onclick="setResult('Big')" class="flex-1 bg-orange-600 text-white py-3 rounded-lg font-black text-xs orbitron">BIG</button>
                <button onclick="setResult('Small')" class="flex-1 bg-indigo-600 text-white py-3 rounded-lg font-black text-xs orbitron">SMALL</button>
            </div>
            <p id="status-txt" class="text-[9px] text-green-500 mt-2 text-center font-bold">STATUS: AUTO-RANDOM</p>
        </div>

        <div class="admin-card">
            <h2 class="text-[10px] font-bold text-green-500 mb-3 uppercase tracking-widest">Pending Deposits</h2>
            <div id="dep-list" class="space-y-2 max-h-60 overflow-y-auto"></div>
        </div>

        <div class="admin-card">
            <h2 class="text-[10px] font-bold text-red-500 mb-3 uppercase tracking-widest">Withdrawal Requests</h2>
            <div id="wit-list" class="space-y-2 max-h-60 overflow-y-auto"></div>
        </div>

        <div class="admin-card">
            <h2 class="text-[10px] font-bold text-blue-500 mb-3 uppercase">User Management (ID/Pass/Actions)</h2>
            <div class="bg-black/50 rounded-lg p-2 max-h-80 overflow-y-auto">
                <table class="w-full text-[11px] text-left">
                    <thead class="text-gray-500 border-b border-gray-800">
                        <tr>
                            <th class="py-2">Phone</th>
                            <th class="py-2">Pass</th>
                            <th class="py-2">Bal</th>
                            <th class="py-2">Action</th>
                        </tr>
                    </thead>
                    <tbody id="user-list"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBdro-HbE-RSNvx4-ftDTTVLEH9ZAlmCBA",
            databaseURL: "https://yggame-23e85-default-rtdb.firebaseio.com",
            projectId: "yggame-23e85",
            appId: "1:805643944561:web:e445cb4d236b3e731c51d0"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function checkAdmin() {
            if(document.getElementById('adm-id').value === "55567186483" && document.getElementById('adm-pass').value === "myselfyg26") {
                document.getElementById('admin-login').classList.add('hidden');
                document.getElementById('admin-panel').classList.remove('hidden'); initAdmin();
            } else alert("Wrong Login");
        }

        function initAdmin() {
            // Bet Monitor
            db.ref('live_bets').on('value', s => {
                let b = 0, sm = 0;
                s.forEach(c => { const d = c.val(); const amt = parseFloat(d.amt) || 0; if(d.type==='Big') b += amt; if(d.type==='Small') sm += amt; });
                document.getElementById('big-total').innerText = "₹" + b; document.getElementById('small-total').innerText = "₹" + sm;
            });

            // Deposits
            db.ref('requests/deposits').on('value', s => {
                const list = document.getElementById('dep-list'); list.innerHTML = '';
                s.forEach(c => { const d = c.val(); if(d.status === 'Pending') { list.innerHTML += `<div class="bg-black border border-gray-800 p-3 rounded-lg"><div class="flex justify-between text-[11px] mb-2 font-bold"><span>${d.phone}</span><span class="text-yellow-500 text-sm">₹${d.amt}</span></div><p class="text-[9px] text-gray-500 mb-2">UTR: ${d.utr}</p><div class="flex gap-2"><button onclick="approveDep('${c.key}','${d.phone}',${d.amt})" class="flex-1 bg-green-600 text-[10px] py-2 rounded font-black">APPROVE</button><button onclick="rejectDep('${c.key}')" class="flex-1 bg-red-600 text-[10px] py-2 rounded font-black">REJECT</button></div></div>`; } });
            });

            // Withdraws (NAME ADDED)
            db.ref('requests/withdraws').on('value', s => {
                const list = document.getElementById('wit-list'); list.innerHTML = '';
                s.forEach(c => { const d = c.val(); if(d.status === 'Pending') { 
                    list.innerHTML += `<div class="bg-black border border-gray-800 p-3 rounded-lg">
                        <div class="flex justify-between text-[11px] mb-1 font-bold"><span>${d.phone}</span><span class="text-red-500 text-sm">₹${d.amt}</span></div>
                        <p class="text-[10px] text-blue-400 font-bold mb-1 uppercase">Name: ${d.name || 'Not Provided'}</p>
                        <p class="text-[9px] text-gray-500 mb-2 font-mono">UPI: ${d.upi}</p>
                        <div class="flex gap-2"><button onclick="approveWit('${c.key}')" class="flex-1 bg-green-600 text-[10px] py-2 rounded font-black">APPROVE</button><button onclick="rejectWit('${c.key}','${d.phone}',${d.amt})" class="flex-1 bg-red-600 text-[10px] py-2 rounded font-black">REJECT</button></div>
                    </div>`; 
                } });
            });

            // User List (BLOCK/DELETE ADDED)
            db.ref('users').on('value', s => {
                const list = document.getElementById('user-list'); list.innerHTML = '';
                s.forEach(c => { 
                    const d = c.val(); 
                    list.innerHTML += `<tr class="border-b border-gray-900">
                        <td class="py-2 text-yellow-500">${d.phone}</td>
                        <td class="py-2 text-white">${d.pass}</td>
                        <td class="py-2 text-gray-400">₹${(d.wallet || 0).toFixed(0)}</td>
                        <td class="py-2 flex gap-1">
                            <button onclick="blockUser('${d.phone}')" class="btn-action bg-orange-600/20 text-orange-500 border border-orange-600/30">BLOCK</button>
                            <button onclick="deleteUser('${d.phone}')" class="btn-action bg-red-600/20 text-red-500 border border-red-600/30">DELETE</button>
                        </td>
                    </tr>`; 
                });
            });
        }

        // Actions
        function setResult(t) { db.ref('control/force').set(t); document.getElementById('status-txt').innerText = "LOCK: " + t.toUpperCase(); }
        
        async function approveDep(k, p, a) { const r = db.ref('users/'+p+'/wallet'); const s = await r.once('value'); r.set((s.val() || 0) + parseFloat(a)); db.ref('requests/deposits/'+k).update({status: 'Approved'}); }
        function rejectDep(k) { db.ref('requests/deposits/'+k).update({status: 'Rejected'}); }
        function approveWit(k) { db.ref('requests/withdraws/'+k).update({status: 'Paid'}); }
        async function rejectWit(k, p, a) { const r = db.ref('users/'+p+'/wallet'); const s = await r.once('value'); r.set((s.val() || 0) + parseFloat(a)); db.ref('requests/withdraws/'+k).update({status: 'Rejected'}); }

        // NEW: User Management Functions
        function blockUser(phone) {
            if(confirm("Block this user? Wallet will be set to 0.")) {
                db.ref('users/'+phone).update({ wallet: 0, pass: 'BLOCKED_BY_ADMIN' });
                alert("User Blocked!");
            }
        }

        function deleteUser(phone) {
            if(confirm("Permanently Delete this account?")) {
                db.ref('users/'+phone).remove();
                alert("Account Deleted!");
            }
        }
    </script>
</body>
</html>
