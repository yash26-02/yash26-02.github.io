<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Multi-Chart Replay System</title>
<style>
  body {
    background: #111;
    color: #fff;
    font-family: Arial, sans-serif;
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
    padding: 20px;
  }
  .chart-container {
    position: relative;
    width: 600px;
    height: 400px;
    border: 1px solid #444;
  }
  .controls {
    position: absolute;
    top: 10px;
    right: 10px;
    z-index: 10;
  }
  .controls input {
    width: 120px;
    padding: 3px;
  }
  .controls button {
    padding: 5px 8px;
    margin-left: 3px;
    cursor: pointer;
  }
</style>
</head>
<body>

<div class="chart-container" id="chart1">
  <div class="controls">
    <input type="text" id="symbol1" placeholder="Symbol (e.g. BTCUSD)">
    <button onclick="loadChart(1)">Load</button>
    <button onclick="startReplay(1)">▶ Play</button>
    <button onclick="pauseReplay(1)">⏸ Pause</button>
    <button onclick="resetReplay(1)">↺ Replay</button>
  </div>
</div>

<div class="chart-container" id="chart2">
  <div class="controls">
    <input type="text" id="symbol2" placeholder="Symbol (e.g. ETHUSD)">
    <button onclick="loadChart(2)">Load</button>
    <button onclick="startReplay(2)">▶ Play</button>
    <button onclick="pauseReplay(2)">⏸ Pause</button>
    <button onclick="resetReplay(2)">↺ Replay</button>
  </div>
</div>

<script src="https://s3.tradingview.com/tv.js"></script>
<script>
let charts = {};
let replayIntervals = {};
let replayProgress = {};

// Function to create TradingView widget
function createChart(containerId, symbol='BINANCE:BTCUSDT') {
    return new TradingView.widget({
        container_id: containerId,
        width: "100%",
        height: "100%",
        symbol: symbol,
        interval: '15',
        timezone: "Etc/UTC",
        theme: "dark",
        style: "1",
        locale: "en",
        enable_publishing: false,
        hide_top_toolbar: false,
        hide_side_toolbar: true,
        withdateranges: true,
        allow_symbol_change: true,
        studies: []
    });
}

// Load chart on button click
function loadChart(chartNum) {
    let symbol = document.getElementById(`symbol${chartNum}`).value.trim();
    if(!symbol) {
        alert("Enter symbol first!");
        return;
    }
    // Clear old interval if exists
    if(replayIntervals[chartNum]) clearInterval(replayIntervals[chartNum]);

    // Initialize replay progress
    replayProgress[chartNum] = 0;

    charts[chartNum] = createChart(`chart${chartNum}`, symbol);
}

// Pseudo replay: scrolls the chart every 1 second
function startReplay(chartNum) {
    if(!charts[chartNum]) {
        alert("Load chart first!");
        return;
    }
    if(replayIntervals[chartNum]) return; // already playing

    replayIntervals[chartNum] = setInterval(() => {
        let iframe = document.querySelector(`#chart${chartNum} iframe`);
        if(!iframe) return;
        // Scroll left to right as replay simulation
        replayProgress[chartNum] = (replayProgress[chartNum] || 0) + 10;
        iframe.contentWindow.scrollBy(10,0); // move horizontally
    }, 500); // every 0.5 sec
}

// Pause pseudo replay
function pauseReplay(chartNum) {
    if(replayIntervals[chartNum]) {
        clearInterval(replayIntervals[chartNum]);
        replayIntervals[chartNum] = null;
    }
}

// Reset pseudo replay
function resetReplay(chartNum) {
    pauseReplay(chartNum);
    replayProgress[chartNum] = 0;
    let iframe = document.querySelector(`#chart${chartNum} iframe`);
    if(iframe) iframe.contentWindow.scrollTo(0,0);
}
</script>
</body>
      </html>
